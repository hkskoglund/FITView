<!DOCTYPE html>
<!-- Basert pÃ¥ http://www.html5rocks.com/en/tutorials/file/dndfiles/#toc-selecting-files-dnd -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>FITView</title>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDvei58o_T1ViClyqpY9728ob_RhbhbiRg&sensor=false"></script>
    <script src="Scripts/3party/jquery-1.9.1.js"></script>
    <script src="Scripts/3party/knockout-2.2.1.debug.js"></script>
    <script src="Scripts/3party/knockout.mapping-latest.debug.js"></script>
    <script src="Scripts/3party/modernizr-2.6.2.js"></script>
    <!-- <script src="Scripts/3party/highcharts.src.js"></script>-->
    <script src="Scripts/3party/highcharts30betasrc.js"></script>

    <script src="Scripts/FITCRCTimestampUtility.js"></script>
    <script src="Scripts/Messages/FITActivityFile.js"></script>

    <script defer="defer" src="Scripts/FITView.js"></script>

    <link href="Stylesheets/dropdownmenu.css" rel="stylesheet" />
    <link href="Stylesheets/StyleMain.css" rel="stylesheet" />
</head>

<body id="body">

    <div>

        <div id="divSessionLap">

            <!-- <div data-bind="text: ko.toJSON($root.headerInfoVM)"></div> -->

            <nav>

                <ul class="menu">


                   

                    <li><a href="#">FITView</a>

                        <ul>
                            <li><a href="#">
                                <input id="inpFITFile" type="file" multiple="multiple" />

                                <progress class="FITprogressImport" id="progressFITimport" max="100" data-bind="value: progressVM.progress"></progress>

                            </a>
                            </li>
                        </ul>
                    </li>

                    <!-- ko with: sessionVM -->

                    <li id="liSessions" style="display: none" data-bind="visible: timestamp().length > 0"><a href="#">Sessions</a>

                        <ul style="max-height: 300px; overflow-y: auto; overflow-x: hidden" data-bind="foreach: timestamp">

                            <li data-bind="with: $parent">

                                <a href="#" data-bind="click: showSession.bind($index())">

                                    <!-- ko if: sport()[$index()] === 1 -->
                                    <img class="sessionSport" alt="Running" title="Running" src="Images/sport/running.png" />
                                    <!-- /ko -->

                                    <!-- ko if: sport()[$index()] === 2 -->
                                    <img class="sessionSport" alt="Cycling" title="Cycling" src="Images/sport/cycling.png" />
                                    <!-- /ko -->

                                    <!-- ko if: sport()[$index()] === 5 -->
                                    <img class="sessionSport" alt="Swimming" title="Swimming" src="Images/sport/swimming.png" />
                                    <!-- /ko -->

                                    <!-- ko if: total_elapsed_time().length > 0  -->
                                    <time><span class="sessionHHMMSS" title="Total elapsed time (includes pauses)" data-bind="text: total_elapsed_time()[$index()].toHHMMSS()"></span></time>
                                    <!-- /ko -->

                                    <!-- ko if: total_distance().length > 0 -->
                                    <span class="sessionTOTALDISTANCE" title="Total distance" data-bind="text: total_distance()[$index()].toFixed(0)"></span>
                                    <!-- /ko -->

                                    <!-- Session trigger -->

                                    <!-- ko if: trigger()[$index()] === 0 -->
                                    <img class="sessionTrigger" src="Images/sessiontrigger/activity_end.png" title="Activity end" />
                                    <!-- /ko -->

                                    <!-- ko if: trigger()[$index()] === 1 -->
                                    <img class="sessionTrigger" src="Images/sessiontrigger/manual.png" title="User changed sport (MODE)" />
                                    <!-- /ko -->

                                    <!-- ko if: trigger()[$index()] === 2 -->
                                    <img class="sessionTrigger" src="Images/sessiontrigger/auto_multi_sport.png" title="Auto multi-sport feature is enabled and user pressed LAP button to advance session" />
                                    <!-- /ko -->

                                    <!-- ko if: trigger()[$index()] === 3 -->
                                    <img class="sessionTrigger" src="Images/sessiontrigger/fitness_equipment.png" title="Auto sport change caused by user linking to fitness equipment" />
                                    <!-- /ko -->

                                    <!-- /ko -->

                                </a>

                            </li>
                        </ul>

                    </li>

                    <!-- /ko -->

                    <!-- ko with: lapVM -->

                    <li id="liLaps" style="display: none" data-bind="visible: timestamp().length > 0"><a href="#">Laps</a>

                        <ul style="max-height: 300px; overflow-y: scroll; overflow-x: scroll" data-bind="foreach: timestamp">

                            <li data-bind="with: $parent">

                                <a href="#" data-bind="click: showLap.bind($index())">

                                    <!-- ko if:  sport()[$index()] === 1 -->
                                    <img class="lapSport" src="Images/sport/running.png" title="Running" alt="Running" />
                                    <!-- /ko -->

                                    <!-- ko if:  sport()[$index()] === 2 -->
                                    <img class="lapSport" src="Images/sport/cycling.png" title="Cycling" alt="Cycling" />
                                    <!-- /ko -->

                                    <!-- ko if:  sport()[$index()] === 5 -->
                                    <img class="lapSport" src="Images/sport/swimming.png" title="Swimming" alt="Swimming" />
                                    <!-- /ko -->


                                    <!-- ko if: total_elapsed_time().length > 0  -->
                                    <time><span class="lapHHMMSS" title="Total elapsed time (includes pauses)" data-bind="text: total_elapsed_time()[$index()].toHHMMSS()"></span></time>
                                    <!-- /ko -->

                                    <!-- ko if: total_distance().length > 0 -->
                                    <span class="lapTOTALDISTANCE" title="Total distance" data-bind="text: total_distance()[$index()].toFixed(0)"></span>
                                    <!-- /ko -->

                                    <!-- SPEED -->

                                    <!-- ko if: avg_speed()[$index()]  || max_speed()[$index()]  -->
                                    <img class="inlineIcon" alt="Speed" title="Speed" src="Images/speed.png" />
                                    <!-- /ko -->


                                    <!-- BIKING/GENERIC -->
                                    <!-- ko if: sport()[$index()] === 2 || sport()[$index()] === 0 || (sport()[$index()] === 1 && $root.speedMode() === 2)-->


                                    <!-- ko if: avg_speed()[$index()] -->
                                    <span title="Average speed" data-bind="text: avg_speed()[$index()].toKMprH()"></span>
                                    <!-- /ko -->

                                    <!-- ko if: max_speed()[$index()]  -->
                                    <span title="Max speed" data-bind="text: max_speed()[$index()].toKMprH()"></span>
                                    <!-- /ko -->
                                    <!-- /ko -->

                                    <!-- RUNNING -->

                                    <!-- ko if: sport()[$index()] === 1  && !((sport()[$index()] === 1 && $root.speedMode() === 2)) -->

                                    <!-- ko if: avg_speed()[$index()] -->
                                    <span title="Average speed" data-bind="text: avg_speed()[$index()].toMINprKM()"></span>
                                    <!-- /ko -->

                                    <!-- ko if: max_speed()[$index()] -->
                                    <span title="Max speed" data-bind="text: max_speed()[$index()].toMINprKM()"></span>
                                    <!-- /ko -->
                                    <!-- /ko -->

                                    <!-- SWIMMING TO DO .... -->

                                    <!-- ko if: sport()[$index()] === 5  -->

                                    <!-- ko if: avg_speed()[$index()] -->
                                    <span title="Average speed" data-bind="text: avg_speed()[$index()].toMINpr100M()"></span>
                                    <!-- /ko -->

                                    <!-- ko if: max_speed()[$index()] -->
                                    <span title="Max speed" data-bind="text: max_speed()[$index()].toMINpr100M()"></span>
                                    <!-- /ko -->
                                    <!-- /ko -->

                                    <!-- HEART RATE -->

                                    <!-- ko if: avg_heart_rate()[$index()] ||  max_heart_rate()[$index()] -->
                                    <img class="inlineIcon" alt="heartrate" title="Heart rate (bpm)" src="Images/heart.png" />
                                    <!-- /ko -->


                                    <!-- ko if:  avg_heart_rate()[$index()]  >= 0 -->
                                    <span title="Average heart rate (bpm)" data-bind="text: avg_heart_rate()[$index()]"></span>
                                    <!-- /ko -->

                                    <!-- ko if: max_heart_rate()[$index()] >= 0 -->
                                    <span title="Max heart rate (bpm)" data-bind="text: max_heart_rate()[$index()]"></span>
                                    <!-- /ko -->


                                    <!-- ko if: total_calories()[$index()] > 0 -->
                                    <img class="inlineIcon" alt="kilo calorie" title="kcal" src="Images/kcalorie.png" />

                                    <span title="Total calories (kcal)" data-bind="text: total_calories()[$index()]"></span>
                                    <!-- /ko -->

                                    <!-- POWER -->

                                    <!-- ko if: avg_power()[$index()] >= 0  ||  max_power()[$index()] >= 0  -->

                                    <img class="inlineIcon" alt="Power" title="Power (w)" src="Images/power.png" />

                                    <span title="Average power (w)" data-bind="text: avg_power()[$index()]"></span>

                                    <span title="Max power (w)" data-bind="text: max_power()[$index()]"></span>

                                    <!-- /ko -->

                                    <!-- CADENCE/STRIDES -->

                                    <!-- ko if: avg_cadence()[$index()] >= 0 || 
                            max_cadence()[$index()] >= 0 ||  
                          total_cycles_strides()[$index()] >=0 -->
                                    <img class="inlineIcon" alt="Cadence" title="Cadence" src="Images/cadence.png" />
                                    <!-- /ko -->

                                    <!-- ko if:  avg_cadence().length > 0  -->
                                    <span title="Average cadence" data-bind="text: avg_cadence()[$index()]"></span>
                                    <!-- /ko -->

                                    <!-- ko if: max_cadence().length > 0  -->
                                    <span title="Max cadence" data-bind="text: max_cadence()[$index()]"></span>
                                    <!-- /ko -->

                                    <!-- ko if: total_cycles_strides().length > 0  -->
                                    <span title="Total cycles/strides" data-bind="text: total_cycles_strides()[$index()]"></span>

                                    <!-- /ko -->

                                    <!-- ASCENT/DESCENT -->

                                    <!-- ko if: total_ascent()[$index()] >= 0  ||  total_descent()[$index()] >= 0 -->

                                    <img class="inlineIcon" alt="Ascent/Descent" title="Ascent/Descent" src="Images/ascent.png" />

                                    <span title="Total ascent (m)" data-bind="text: total_ascent()[$index()]"></span>

                                    <span title="Total descent (m)" data-bind="text: total_descent()[$index()]"></span>

                                    <!-- /ko -->


                                    <!-- ko if: avg_temperature()[$index()] >= 0  ||  max_temperature()[$index()] >= 0  -->

                                    <img class="inlineIcon" alt="Temperature" title="Temperature (C)" src="Images/temperature.png" />

                                    <span title="Average temperature (C)" data-bind="text: avg_temperature()[$index()]"></span>

                                    <span title="Max temperature (C)" data-bind="text: max_temperature()[$index()]"></span>

                                    <!-- /ko -->

                                    <!-- ko if: lap_trigger  && lap_trigger()[$index()] === 0 -->
                                    <img class="lapTrigger" src="Images/laptrigger/manual.png" title="LAP pressed" />
                                    <!-- /ko -->

                                    <!-- ko if: lap_trigger  && lap_trigger()[$index()] === 1 -->
                                    <img class="lapTrigger" src="Images/laptrigger/time.png" title="Time" />
                                    <!-- /ko -->

                                    <!-- ko if: lap_trigger && lap_trigger()[$index()] === 2 -->
                                    <img class="lapTrigger" src="Images/laptrigger/distance.png" title="Distance" />
                                    <!-- /ko -->

                                    <!-- ko if: lap_trigger  && lap_trigger()[$index()] === 3 -->
                                    <img class="lapTrigger" src="Images/laptrigger/position_start.png" title="Position start" />
                                    <!-- /ko -->

                                    <!-- ko if: lap_trigger  && lap_trigger()[$index()] === 4 -->
                                    <img class="lapTrigger" src="Images/laptrigger/position_lap.png" title="Position lap" />
                                    <!-- /ko -->

                                    <!-- ko if: lap_trigger && lap_trigger()[$index()] === 5 -->
                                    <img class="lapTrigger" src="Images/laptrigger/position_waypoint.png" title="Position waypoint" />
                                    <!-- /ko -->

                                    <!-- ko if: lap_trigger  && lap_trigger()[$index()] === 6 -->
                                    <img class="lapTrigger" src="Images/laptrigger/position_marked.png" title="Position marked" />
                                    <!-- /ko -->

                                    <!-- ko if: lap_trigger  && lap_trigger()[$index()] === 7 -->
                                    <img class="lapTrigger" src="Images/laptrigger/session_end.png" title="Session end" />
                                    <!-- /ko -->

                                </a>
                            </li>
                        </ul>
                    </li>

                    <!-- /ko -->

                    <!-- ko with: settingsVM -->
                    <li><a href="#">Settings</a>
                        <ul>
                            <li><a href="#">

                                <div>
                                    <input type="checkbox" data-bind="checked: showLapLines" />
                                    Lap lines
                                </div>

                            </a>
                            </li>

                            <li><a href="#">

                                <div>
                                    <input type="checkbox" data-bind="checked: showLapTriggers" />
                                    Lap triggers
                                </div>

                            </a>
                            </li>

                            <li><a href="#">

                                <div>
                                    <input type="checkbox" data-bind="checked: showEvents" />
                                    Events
                                </div>

                            </a>
                            </li>

                           <!-- <li><a href="#">

                                <div>
                                    <input type="checkbox" data-bind="checked: showLegends" />
                                    Chart legends
                                </div>

                            </a>
                            </li>-->

                            <!--<li><a href="#">

                                <div>
                                    <input type="checkbox" data-bind="checked: storeInIndexedDB" />
                                    Use IndexedDB
                                </div>
                            </a>
                            </li>-->

                            <li><a href="#">

                                <div>
                                    <input type="checkbox" data-bind="checked: showDeviceInfo" />
                                    Devices/Sensors
                                </div>
                            </a>
                            </li>

                            <!--<li><a href="#">

                                <div>
                                    <input type="checkbox" data-bind="checked: showHeaderInfo" />
                                    FIT header info.
                                </div>
                            </a>
                            </li>-->

                            <li><a href="#">

                                <div>
                                    <input type="checkbox" data-bind="checked: forceSpeedKMprH" />
                                    Run speed in km/h
                                </div>
                            </a>
                            </li>

                            <!--<li><a href="#">

                            <div>
                                <input type="checkbox" data-bind="checked: requestHideAltitude" />
                                Hide altitude data
                            </div>
                        </a>
                        </li>-->

                            <li><a href="#">

                                <div>
                                    <input type="checkbox" data-bind="checked: requestAveragingOnSpeed" />
                                    Average speed
                                </div>
                            </a>
                            </li>

                            <li><a href="#">

                                <div>
                                    Avg.speed sample
                                <input type="range" min="3000" max="120000" data-bind="value: averageSampleTime" />
                                    <span data-bind="text: averageSampleTime"></span>ms
                                </div>
                            </a>
                            </li>

                            <li><a href="#">
                                <div>
                                    <input type="checkbox" data-bind="checked: distanceOnXAxis" />
                                    Distance (km) on X-axis
                                </div>
                            </a>
                            </li>

                             <li><a href="#">
 	 	
                                <div>
 	 	
                                    <input type="checkbox" data-bind="checked: TEIntensityPlotbands" />
 	 
                                    TE intensity plotbands
 	 
                                </div>
 	 	
                            </a>
 		
                            </li>

                        </ul>
                    </li>
                    <!-- /ko -->

                     <!-- ko with: exportVM -->
                    <li>
                        <a href="#">Export</a>
                        <ul>
                            
                             <li>
                                <div>
                                    <input type="checkbox" title="Include header in CSV (top row)" data-bind="checked: csv.header"/>
                                    <label style="color: white">Header</label>
                                   <!-- <input type="text"  title="Name of CSV data column" data-bind="value: headerTitle" /> -->
                                    <select data-bind="options: csv.type, value: csv.selectedType" title="Type of CSV export"></select>
                                    <label style="color: white">Scale</label>
                                    <input type="text"  title="1 = seconds, 1000 = ms." data-bind="value: csv.scale" /> 
                                </div>
                             <a href="#"></a>
                            </li>

                            <li >
                                <a id="aExportHRV_CSV" title="Export HRV as CSV" data-bind="click: csv.tryMSBlobSave">
                                    Export HRV as CSV 
                            </a>
                            </li>
                            
                            
                        </ul>

                    </li>
                    <!-- /ko -->

                    
                    <li>
                        <div id="zonesChart"></div>
                        
                        <!--<ul>
                            <li><a href="#"></a>
                                 
                            </li>
                        </ul>-->
                    </li>

                    <!--               <li>
                   <div data-bind="text: ko.toJSON($root)"></div>

               </li>   -->

                </ul>
            </nav>

            <!-- <div data-bind="text: ko.toJSON($root.activityVM)"></div>-->

            <!-- ko with: headerInfoVM -->

            <!-- <div id="divHeartRateZones" style="width: 30%">
                <h1 style="font-size: larger; text-align: center">Heart rate zones</h1>
                <ul style="list-style : none">
                    <li>
                        <input type="text" placeholder="HR zone 1"/><input type="range" min="0" max="300"  /></li>
                    <li>
                        <input type="text" placeholder="HR zone 2"/><input type="range" min="0" max="300"  /></li>
                    <li>
                       <input type="text" placeholder="HR zone 3"/><input type="range" min="0" max="300"  /></li>
                    <li>
                        <input type="text" placeholder="HR zone 4"/><input type="range" min="0" max="300"  /></li>
                    <li>
                        <input type="text" placeholder="HR zone 5"/><input type="range" min="0" max="300" /></li>
                    
                </ul>
                <button id="btnSaveHRZones" style="float: right">Save</button>
            </div>-->

            <div id="divHeaderInfo" data-bind="visible: $parent.settingsVM.showHeaderInfo">
                Header info: 
                <span title="File name" data-bind="text: fileName"></span>
                <span title="File size" data-bind="text: fileSize"></span>
                <span title="Data type" data-bind="text: dataType"></span>
                <span title="Header size" data-bind="text: headerSize"></span>
                <span title="Data size" data-bind="text: dataSize"></span>
                <span title="Protocol version" data-bind="text: protocolVersion"></span>
                <span title="Profile version" data-bind="text: profileVersion"></span>
                <span title="CRC" data-bind="text: headerCRC"></span>

            </div>
            <!-- /ko -->

            <!-- ko with: sessionVM -->
            <div id="sessionDetails">
                <!--<div data-bind="text: ko.toJSON($root)"></div>-->

                <!-- ko if: selectedSession() !== undefined -->


                <!-- ko if: sport()[selectedSession()] === 1 -->
                <img class="inlineIcon" alt="Running" title="Running" src="Images/sport/running.png" />
                <!-- /ko -->

                <!-- ko if: sport()[selectedSession()] === 2 -->
                <img class="inlineIcon" alt="Cycling" title="Cycling" src="Images/sport/cycling.png" />
                <!-- /ko -->

                <!-- ko if: sport()[selectedSession()] === 5 -->
                <img class="inlineIcon" alt="Swimming" title="Swimming" src="Images/sport/swimming.png" />
                <!-- /ko -->

                <!-- ko if : start_time()[selectedSession()] -->

                <span data-bind="text: Highcharts.dateFormat('%A %e %B %Y %H:%M:%S', start_time()[selectedSession()]+$parent.settingsVM.timeZoneDifferenceUTC)"></span>
                <!-- /ko -->


                <!-- ko if: total_elapsed_time().length > 0  -->
                <time><span class="sessionHHMMSS" title="Total elapsed time (includes pauses)" data-bind="text: total_elapsed_time()[selectedSession()].toHHMMSS()"></span></time>
                <!-- /ko -->



                <!-- ko if: total_timer_time().length > 0  && total_timer_time()[selectedSession()].toHHMMSS() !== total_elapsed_time()[selectedSession()].toHHMMSS() -->

                <time><span class="sessionHHMMSS" title="Total timer time (excludes pauses)" data-bind="text: total_timer_time()[selectedSession()].toHHMMSS()"></span></time>
                <!-- /ko -->

                <!-- ko if: total_distance().length > 0 -->
                <span class="sessionTOTALDISTANCE" title="Total distance (m)" data-bind="text: total_distance()[selectedSession()].toFixed(0)"></span>
                <!-- /ko -->

                <!-- SPEED -->

                <!-- ko if: avg_speed()[selectedSession()]  || max_speed()[selectedSession()]  -->
                <img class="inlineIcon" alt="Speed" title="Speed" src="Images/speed.png" />
                <!-- /ko -->


                <!-- BIKING/GENERIC -->
                <!-- ko if: sport()[selectedSession()] === 2 || sport()[selectedSession()] === 0  -->


                <!-- ko if: avg_speed()[selectedSession()] -->
                <span title="Average speed" data-bind="text: avg_speed()[selectedSession()].toKMprH()"></span>
                <!-- /ko -->

                <!-- ko if: max_speed()[selectedSession()]  -->
                <span title="Max speed" data-bind="text: max_speed()[selectedSession()].toKMprH()"></span>
                <!-- /ko -->
                <!-- /ko -->

                <!-- RUNNING -->

                <!-- ko if: sport()[selectedSession()] === 1 && $parent.speedMode() === 1-->

                <!-- ko if: avg_speed()[selectedSession()] -->
                <span title="Average speed" data-bind="text: avg_speed()[selectedSession()].toMINprKM()"></span>
                <!-- /ko -->

                <!-- ko if: max_speed()[selectedSession()] -->
                <span title="Max speed" data-bind="text: max_speed()[selectedSession()].toMINprKM()"></span>
                <!-- /ko -->
                <!-- /ko -->

                <!-- ko if: sport()[selectedSession()] === 1 && $parent.speedMode() === 2 -->

                <!-- ko if: avg_speed()[selectedSession()] -->
                <span title="Average speed" data-bind="text: avg_speed()[selectedSession()].toKMprH()"></span>
                <!-- /ko -->

                <!-- ko if: max_speed()[selectedSession()] -->
                <span title="Max speed" data-bind="text: max_speed()[selectedSession()].toKMprH()"></span>
                <!-- /ko -->
                <!-- /ko -->

                <!-- SWIMMING TO DO .... -->

                <!-- ko if: sport()[selectedSession()] === 5  -->

                <!-- ko if: avg_speed()[selectedSession()] -->
                <span title="Average speed" data-bind="text: avg_speed()[selectedSession()].toMINpr100M()"></span>
                <!-- /ko -->

                <!-- ko if: max_speed()[selectedSession()] -->
                <span title="Max speed" data-bind="text: max_speed()[selectedSession()].toMINpr100M()"></span>
                <!-- /ko -->
                <!-- /ko -->

                <!-- HEART RATE -->

                <!-- ko if: avg_heart_rate()[selectedSession()] ||  max_heart_rate()[selectedSession()] -->
                <img class="inlineIcon" alt="heartrate" title="Heart rate (bpm)" src="Images/heart.png" />
                <!-- /ko -->


                <!-- ko if:  avg_heart_rate()[selectedSession()]  >= 0 -->
                <span title="Average heart rate (bpm)" data-bind="text: avg_heart_rate()[selectedSession()]"></span>
                <!-- /ko -->

                <!-- ko if: max_heart_rate()[selectedSession()] >= 0 -->
                <span title="Max heart rate (bpm)" data-bind="text: max_heart_rate()[selectedSession()]"></span>
                <!-- /ko -->


                <!-- ko if: total_calories()[selectedSession()] > 0 -->
                <img class="inlineIcon" alt="kilo calorie" title="kcal" src="Images/kcalorie.png" />

                <span title="Total calories (kcal)" data-bind="text: total_calories()[selectedSession()]"></span>
                <!-- /ko -->


                <!-- POWER -->

                <!-- ko if: avg_power()[selectedSession()] >= 0  ||  max_power()[selectedSession()] >= 0  -->

                <img class="inlineIcon" alt="Power" title="Power (w)" src="Images/power.png" />

                <span title="Average power (w)" data-bind="text: avg_power()[selectedSession()]"></span>

                <span title="Max power (w)" data-bind="text: max_power()[selectedSession()]"></span>

                <!-- /ko -->


                <!-- CADENCE/STRIDES -->

                <!-- ko if: avg_cadence()[selectedSession()] >= 0 || 
                            max_cadence()[selectedSession()] >= 0 ||  
                          total_cycles_strides()[selectedSession()] >=0 -->
                <img class="inlineIcon" alt="Cadence" title="Cadence" src="Images/cadence.png" />
                <!-- /ko -->

                <!-- ko if:  avg_cadence().length > 0  -->
                <span title="Average cadence" data-bind="text: avg_cadence()[selectedSession()]"></span>
                <!-- /ko -->

                <!-- ko if: max_cadence().length > 0  -->
                <span title="Max cadence" data-bind="text: max_cadence()[selectedSession()]"></span>
                <!-- /ko -->

                <!-- ko if: total_cycles_strides().length > 0  -->
                <span title="Total cycles/strides" data-bind="text: total_cycles_strides()[selectedSession()]"></span>

                <!-- /ko -->

                <!-- ASCENT/DESCENT -->

                <!-- ko if: total_ascent()[selectedSession()] >= 0  ||  total_descent()[selectedSession()] >= 0 -->

                <img class="inlineIcon" alt="Ascent/Descent" title="Ascent/Descent" src="Images/ascent.png" />

                <span title="Total ascent (m)" data-bind="text: total_ascent()[selectedSession()]"></span>

                <span title="Total descent (m)" data-bind="text: total_descent()[selectedSession()]"></span>

                <!-- /ko -->

                <!-- ko if: avg_temperature()[selectedSession()] >= 0  ||  max_temperature()[selectedSession()] >= 0  -->

                <img class="inlineIcon" alt="Temperature" title="Temperature (C)" src="Images/temperature.png" />

                <span title="Average temperature (C)" data-bind="text: avg_temperature()[selectedSession()]"></span>

                <span title="Max temperature (C)" data-bind="text: max_temperature()[selectedSession()]"></span>

                <!-- /ko -->


                <!-- ko if:  total_training_effect()[selectedSession()] >= 1 -->
                TE
                        <span data-bind="text: total_training_effect()[selectedSession()]"></span>

                <!-- meter tag ignored in  IE 10, but works in Chrome -->
                <meter title="Training effect" style="padding-left: 5px; padding-bottom: 6px" high="4" low="1.5" min="1" max="5" data-bind="value: total_training_effect()[selectedSession()]"></meter>
                <!-- /ko -->



                <!-- Session trigger -->



                <!-- ko if: trigger()[selectedSession()] === 0 -->
                <img class="sessionTrigger" src="Images/sessiontrigger/activity_end.png" title="Activity end" />
                <!-- /ko -->

                <!-- ko if: trigger()[selectedSession()] === 1 -->
                <img class="sessionTrigger" src="Images/sessiontrigger/manual.png" title="User changed sport (MODE)" />
                <!-- /ko -->

                <!-- ko if: trigger()[selectedSession()] === 2 -->
                <img class="sessionTrigger" src="Images/sessiontrigger/auto_multi_sport.png" title="Auto multi-sport feature is enabled and user pressed LAP button to advance session" />
                <!-- /ko -->

                <!-- ko if: trigger()[selectedSession()] === 3 -->
                <img class="sessionTrigger" src="Images/sessiontrigger/fitness_equipment.png" title="Auto sport change caused by user linking to fitness equipment" />
                <!-- /ko -->

                <!-- /ko -->

            </div>
            <!-- /ko -->

            <!-- ko with: lapVM -->
            <div id="lapDetails">
                <!--<div data-bind="text: ko.toJSON($root)"></div>-->

                <!-- ko if: selectedLap() !== undefined -->


                <!-- ko if: sport()[selectedLap()] === 1 -->
                <img class="inlineIcon" alt="Running" title="Running" src="Images/sport/running.png" />
                <!-- /ko -->

                <!-- ko if: sport()[selectedLap()] === 2 -->
                <img class="inlineIcon" alt="Cycling" title="Cycling" src="Images/sport/cycling.png" />
                <!-- /ko -->

                <!-- ko if: sport()[selectedLap()] === 5 -->
                <img class="inlineIcon" alt="Swimming" title="Swimming" src="Images/sport/swimming.png" />
                <!-- /ko -->

                <!-- ko if : start_time()[selectedLap()] -->

                <span data-bind="text: Highcharts.dateFormat('%A %e %B %Y %H:%M:%S', start_time()[selectedLap()]+$parent.settingsVM.timeZoneDifferenceUTC)"></span>
                <!-- /ko -->


                <!-- ko if: total_elapsed_time().length > 0  -->
                <time><span class="sessionHHMMSS" title="Total elapsed time (includes pauses)" data-bind="text: total_elapsed_time()[selectedLap()].toHHMMSS()"></span></time>
                <!-- /ko -->



                <!-- ko if: total_timer_time().length > 0 && selectedLap() !== undefined && total_timer_time()[selectedLap()].toHHMMSS() !== total_elapsed_time()[selectedLap()].toHHMMSS() -->

                <time><span class="sessionHHMMSS" title="Total timer time (excludes pauses)" data-bind="text: total_timer_time()[selectedLap()].toHHMMSS()"></span></time>
                <!-- /ko -->

                <!-- ko if: total_distance().length > 0 -->
                <span class="sessionTOTALDISTANCE" title="Total distance (m)" data-bind="text: total_distance()[selectedLap()].toFixed(0)"></span>
                <!-- /ko -->

                <!-- SPEED -->

                <!-- ko if: avg_speed()[selectedLap()]  || max_speed()[selectedLap()]  -->
                <img class="inlineIcon" alt="Speed" title="Speed" src="Images/speed.png" />
                <!-- /ko -->


                <!-- BIKING/GENERIC -->
                <!-- ko if: sport()[selectedLap()] === 2 || sport()[selectedLap()] === 0  -->


                <!-- ko if: avg_speed()[selectedLap()] -->
                <span title="Average speed" data-bind="text: avg_speed()[selectedLap()].toKMprH()"></span>
                <!-- /ko -->

                <!-- ko if: max_speed()[selectedLap()]  -->
                <span title="Max speed" data-bind="text: max_speed()[selectedLap()].toKMprH()"></span>
                <!-- /ko -->
                <!-- /ko -->

                <!-- RUNNING -->

                <!-- ko if: sport()[selectedLap()] === 1 && $parent.speedMode() === 1-->

                <!-- ko if: avg_speed()[selectedLap()] -->
                <span title="Average speed" data-bind="text: avg_speed()[selectedLap()].toMINprKM()"></span>
                <!-- /ko -->

                <!-- ko if: max_speed()[selectedLap()] -->
                <span title="Max speed" data-bind="text: max_speed()[selectedLap()].toMINprKM()"></span>
                <!-- /ko -->
                <!-- /ko -->

                <!-- ko if: sport()[selectedLap()] === 1 && $parent.speedMode() === 2 -->

                <!-- ko if: avg_speed()[selectedLap()] -->
                <span title="Average speed" data-bind="text: avg_speed()[selectedLap()].toKMprH()"></span>
                <!-- /ko -->

                <!-- ko if: max_speed()[selectedLap()] -->
                <span title="Max speed" data-bind="text: max_speed()[selectedLap()].toKMprH()"></span>
                <!-- /ko -->
                <!-- /ko -->

                <!-- SWIMMING TO DO .... -->

                <!-- ko if: sport()[selectedLap()] === 5  -->

                <!-- ko if: avg_speed()[selectedLap()] -->
                <span title="Average speed" data-bind="text: avg_speed()[selectedLap()].toMINpr100M()"></span>
                <!-- /ko -->

                <!-- ko if: max_speed()[selectedLap()] -->
                <span title="Max speed" data-bind="text: max_speed()[selectedLap()].toMINpr100M()"></span>
                <!-- /ko -->
                <!-- /ko -->

                <!-- HEART RATE -->

                <!-- ko if: avg_heart_rate()[selectedLap()] ||  max_heart_rate()[selectedLap()] -->
                <img class="inlineIcon" alt="heartrate" title="Heart rate (bpm)" src="Images/heart.png" />
                <!-- /ko -->


                <!-- ko if:  avg_heart_rate()[selectedLap()]  >= 0 -->
                <span title="Average heart rate (bpm)" data-bind="text: avg_heart_rate()[selectedLap()]"></span>
                <!-- /ko -->

                <!-- ko if: max_heart_rate()[selectedLap()] >= 0 -->
                <span title="Max heart rate (bpm)" data-bind="text: max_heart_rate()[selectedLap()]"></span>
                <!-- /ko -->


                <!-- ko if: total_calories()[selectedLap()] > 0 -->
                <img class="inlineIcon" alt="kilo calorie" title="kcal" src="Images/kcalorie.png" />

                <span title="Total calories (kcal)" data-bind="text: total_calories()[selectedLap()]"></span>
                <!-- /ko -->


                <!-- POWER -->

                <!-- ko if: avg_power()[selectedLap()] >= 0  ||  max_power()[selectedLap()] >= 0  -->

                <img class="inlineIcon" alt="Power" title="Power (w)" src="Images/power.png" />

                <span title="Average power (w)" data-bind="text: avg_power()[selectedLap()]"></span>

                <span title="Max power (w)" data-bind="text: max_power()[selectedLap()]"></span>

                <!-- /ko -->


                <!-- CADENCE/STRIDES -->

                <!-- ko if: avg_cadence()[selectedLap()] >= 0 || 
                            max_cadence()[selectedLap()] >= 0 ||  
                          total_cycles_strides()[selectedLap()] >=0 -->
                <img class="inlineIcon" alt="Cadence" title="Cadence" src="Images/cadence.png" />
                <!-- /ko -->

                <!-- ko if:  avg_cadence().length > 0  -->
                <span title="Average cadence" data-bind="text: avg_cadence()[selectedLap()]"></span>
                <!-- /ko -->

                <!-- ko if: max_cadence().length > 0  -->
                <span title="Max cadence" data-bind="text: max_cadence()[selectedLap()]"></span>
                <!-- /ko -->

                <!-- ko if: total_cycles_strides().length > 0  -->
                <span title="Total cycles/strides" data-bind="text: total_cycles_strides()[selectedLap()]"></span>

                <!-- /ko -->

                <!-- ASCENT/DESCENT -->

                <!-- ko if: total_ascent()[selectedLap()] >= 0  ||  total_descent()[selectedLap()] >= 0 -->

                <img class="inlineIcon" alt="Ascent/Descent" title="Ascent/Descent" src="Images/ascent.png" />

                <span title="Total ascent (m)" data-bind="text: total_ascent()[selectedLap()]"></span>

                <span title="Total descent (m)" data-bind="text: total_descent()[selectedLap()]"></span>

                <!-- /ko -->

                <!-- ko if: avg_temperature()[selectedLap()] >= 0  ||  max_temperature()[selectedLap()] >= 0  -->

                <img class="inlineIcon" alt="Temperature" title="Temperature (C)" src="Images/temperature.png" />

                <span title="Average temperature (C)" data-bind="text: avg_temperature()[selectedLap()]"></span>

                <span title="Max temperature (C)" data-bind="text: max_temperature()[selectedLap()]"></span>

                <!-- /ko -->

                <!-- ko if: lap_trigger  && lap_trigger()[selectedLap()] === 0 -->
                <img class="lapTrigger" src="Images/laptrigger/manual.png" title="LAP pressed" />
                <!-- /ko -->


                <!-- ko if: lap_trigger  && lap_trigger()[selectedLap()] === 1 -->
                <img class="lapTrigger" src="Images/laptrigger/time.png" title="Time" />
                <!-- /ko -->

                <!-- ko if: lap_trigger && lap_trigger()[selectedLap()] === 2 -->
                <img class="lapTrigger" src="Images/laptrigger/distance.png" title="Distance" />
                <!-- /ko -->

                <!-- ko if: lap_trigger  && lap_trigger()[selectedLap()] === 3 -->
                <img class="lapTrigger" src="Images/laptrigger/position_start.png" title="Position start" />
                <!-- /ko -->

                <!-- ko if: lap_trigger  && lap_trigger()[selectedLap()] === 4 -->
                <img class="lapTrigger" src="Images/laptrigger/position_lap.png" title="Position lap" />
                <!-- /ko -->

                <!-- ko if: lap_trigger && lap_trigger()[selectedLap()] === 5 -->
                <img class="lapTrigger" src="Images/laptrigger/position_waypoint.png" title="Position waypoint" />
                <!-- /ko -->

                <!-- ko if: lap_trigger  && lap_trigger()[selectedLap()] === 6 -->
                <img class="lapTrigger" src="Images/laptrigger/position_marked.png" title="Position marked" />
                <!-- /ko -->

                <!-- ko if: lap_trigger  && lap_trigger()[selectedLap()] === 7 -->
                <img class="lapTrigger" src="Images/laptrigger/session_end.png" title="Session end" />
                <!-- /ko -->





                <!-- /ko -->

            </div>
            <!-- /ko -->




            <section id="divLaps">



                <!-- <h4>Laps</h4>-->
                <!-- ko if: $root !== undefined && $root.timestamp !== undefined -->
                <section id="lapList" data-bind="foreach: timestamp">
                </section>
                <!-- /ko -->

                <!--<div data-bind="text: ko.toJSON($root)"></div>

            <hr/> -->

            </section>

            <div id="divMapWrapper">
                <div>
                    <img id="liveImage" src="http://195.18.181.101/mjpg/video.mjpg" />
                </div>
                <!-- ko with: activityVM -->
                <div id="importedActivities">

                    <div style="position: relative; top: 10px; left: 10px; font-weight:bold" data-bind="visible: activity().length === 0">Please import activities to explore</div>

                    <ul id="activityList" data-bind=" foreach: activity">

                        
                        <li class="newActivity" data-bind="style: { 'background-color': $parent.intenseActivity($data)}">
                           <!-- http://stackoverflow.com/questions/9261296/any-good-techniques-to-debug-template-binding-faults-for-knockout-js -->
                           <!-- <pre data-bind="text: ko.toJSON($data, null, 2)"></pre>-->
                                <div style="float: left; width: 200px;">
                                    <a href="#" data-bind="click: $parent.showActivity.bind($index())">
                                        <!-- ko if: typeof (record) !== "undefined" && typeof (record.timestamp) !== "undefined" && record.timestamp.length > 0 -->
                                        <span style="display: inline" data-bind="text : (new Date(record.timestamp[0])).toLocaleString(), attr: { title: 'Filename: '+ _headerInfo_.fitFile.name + ' Size: '+_headerInfo_.fitFile.size+ ' bytes'}"></span>
                                        <!-- /ko -->

                                        <!-- ko if: typeof (record) === "undefined" -->
                                        <span style="display: inline">No data.</span>
                                        <!-- /ko -->

                                        <!-- ko ifnot:  (typeof (record) !== "undefined" && typeof (record.timestamp) !== "undefined" && record.timestamp.length > 0) -->
                                        <!-- ko if: session && session.start_time && session.start_time.length > 0 -->
                                        <span style="display: inline" data-bind="text : (new Date(session.start_time[0])).toLocaleString()"></span>
                                        <!-- /ko -->
                                        <!-- /ko -->

                                        <!-- ko with: session -->

                                        <!--  <div data-bind="text: ko.toJSON($parent.hrv)"></div>-->

                                        <ul id="sportList" data-bind="foreach: sport">

                                            <li style="display: inline" data-bind="with: $parent">
                                                <div style="display: inline-block">

                                                    <!-- ko if: sport[$index()] === 1 -->
                                                    <img class="inlineIcon" alt="Running" title="Running" src="Images/sport/running.png" />
                                                    <!-- /ko -->

                                                    <!-- ko if: sport[$index()] === 2 -->
                                                    <img class="inlineIcon" alt="Cycling" title="Cycling" src="Images/sport/cycling.png" />
                                                    <!-- /ko -->

                                                    <!-- ko if: sport[$index()] === 5 -->
                                                    <img class="inlineIcon" alt="Swimming" title="Swimming" src="Images/sport/swimming.png" />
                                                    <!-- /ko -->

                                                    <!-- ko if: sport[$index()] !== 5 && sport[$index()]!== 2 && sport[$index()] !== 1 -->
                                                    <img class="inlineIcon" src="Images/sport/generic.png" data-bind="attr: {title : 'Sport is '+sport[$index()],
                                                            alt : 'Sport is '+sport[$index()]}" />
                                                    <!-- /ko -->

                                                    <!-- ko if: typeof (total_distance) !== "undefined" && total_distance.length > 0  -->

                                                    <!-- ko if: total_distance[$index()] > 0 && total_distance[$index()] < 1000 -->
                                                    <span class="sessionTOTALDISTANCE" title="Total distance" data-bind="text: total_distance[$index()].toFixed(0)+ ' m'"></span>
                                                    <!-- /ko -->

                                                    <!-- ko if: total_distance[$index()] > 0 && total_distance[$index()] > 1000 -->
                                                    <span class="sessionTOTALDISTANCE" title="Total distance" data-bind="text: (total_distance[$index()]/1000).toFixed(1)+' km'"></span>
                                                    <!-- /ko -->
                                                    <!-- /ko -->

                                                    <!-- ko if: typeof (avg_heart_rate) !== "undefined" || typeof (max_heart_rate) !== "undefined" -->
                                                    <img class="inlineIcon" alt="Heart rate" title="bpm" src="Images/heart.png" />

                                                    <!-- ko if:  avg_heart_rate[$index()]  >= 0 -->
                                                    <span title="Average heart rate (bpm)" data-bind="text: avg_heart_rate[$index()]"></span>
                                                    <!-- /ko -->

                                                    <!-- ko if: max_heart_rate[$index()] >= 0 -->
                                                    <span title="Max heart rate (bpm)" data-bind="text: max_heart_rate[$index()]"></span>
                                                    <!-- /ko -->

                                                    <!-- /ko -->

                                                    <!-- ko with: $parents[2] -->
                                                    <!-- ko if: typeof (hrv) !== "undefined" && typeof (hrv.time) !== "undefined" && hrv.time.length > 0 -->
                                                    <span data-bind="attr: { title: 'Contains '+hrv.time.length+' heart rate variability measurements'}">HRV</span>
                                                    <!-- /ko -->
                                                    <!-- /ko -->

                                                    <!-- ko if: typeof (total_calories) !== "undefined" && total_calories.length > 0 && total_calories[$index()] > 0 -->
                                                    <img class="inlineIcon" alt="kilo calorie" title="kcal" src="Images/kcalorie.png" />

                                                    <span title="Total calories (kcal)" data-bind="text: total_calories[$index()]"></span>
                                                    <!-- /ko -->


                                                    <!-- ko if: typeof (total_training_effect) !== "undefined" &&  total_training_effect[$index()] >= 1 -->
                                                    TE
                                                         <span data-bind="text: total_training_effect[$index()]"></span>

                                                    <!-- meter tag ignored in  IE 10, but works in Chrome -->
                                                    <meter title="Training effect" style="padding-left: 5px; padding-bottom: 6px" high="4" low="1.5" min="1" max="5" data-bind="value: total_training_effect[$index()]"></meter>
                                                    <!-- /ko -->
                                                </div>
                                            </li>

                                        </ul>

                                        <!-- /ko -->
                                    </a>
                                </div>

                                <div style="float: right; width: 100px">
                                    <!-- ko if: typeof (_staticGoogleMapSrc) !== "undefined" -->
                                    <img data-bind="attr: { src :  _staticGoogleMapSrc }" />
                                    <!-- /ko -->
                                </div>
                           

                        </li>

                    </ul>

               </div>
                 <!-- /ko -->

                <div id="activityMap"></div>
               
            </div>

        </div>

        <div id="divChartWrapper">

            <div id="multiChart"></div>
            

        </div>

        <div id="divMsgMap"></div>


    </div>

</body>

</html>
